---
title: "Bayes_Rules!_Notebook"
format: html
editor: visual
---

## Chapter 2: Bayes' Rule

```{r}
library(bayesrules)
library(tidyverse)

set_theme(theme_bw(base_size = 16, base_family = "Barlow"))
```

```{r}
data(fake_news)
fake_news <- fake_news |> as_tibble()

fake_news |> 
  count(type)
```

```{r}
fake_news |> 
  summarize(n = n(), .by = c(title_has_excl, type))
```

```{r}
sim_params <- tibble(type = c("real", "fake"),
                     prior = c(0.6, 0.4))

set.seed(1234)

sims <- sample(sim_params$type, size = 10000, prob = sim_params$prior, replace = TRUE) |>
  enframe(value = "type") |> 
  mutate(data_model = case_when(
    type == "fake" ~ .2667,
    type == "real" ~ .0222
  )) |> 
  rowwise() |> 
  mutate(usage = sample(
    c("no", "yes"), size = 1, prob = c(1- data_model, data_model)
    )) |> 
  ungroup()

sims |> 
  summarize(n = n(), .by = c(usage, type))
```

```{r}
ggplot(sims) +
  aes(x = type, fill = usage) +
  geom_bar(position = "fill")
```

```{r}
data("pop_vs_soda")

pop_vs_soda |> 
  summarize(n = n(), .by = c(pop, region))
```

```{r}
chess <- c(0.2, .5, .8)
prior <- c(0.1, 0.25, 0.65)

set.seed(1234)
chess_sim <- tibble(
  pi = sample(chess, size = 10000, prob = prior, replace = TRUE) 
)|> 
  mutate(y = rbinom(n(), size = 6, prob = pi))

chess_sim |> 
  count(pi) |> 
  mutate(prop = n / sum(n))
```

```{r}
chess_sim |> 
  ggplot() +
  aes(x = y) +
  stat_count(aes(y = after_stat(prop))) +
  facet_wrap(~pi)
```

```{r}

```
